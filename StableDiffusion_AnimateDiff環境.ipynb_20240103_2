{"cells":[{"cell_type":"markdown","source":["★事前準備★\n","\n","ご自分の「Googleドライブ」の「MyDrive」に 以下のフォルダ構成と\n","\n","任意でGoogleColab上の「Stable-Diffusion_WEB-UI」で使用したいデータを格納してください。\n","\n","MyDrive\n","\n","└StableDiffusion\n","\n"," 　└checkpoints　※使用したいモデルデータを格納\n","\n"," 　└controlnet　※ツール用モデルを格納\n","\n"," 　└embeddings　※EasyNegativeなどを格納\n","\n"," 　└lora　※使用したいLoRAデータを格納\n","\n"," 　└VAE　※使用したいVAEデータを格納\n","\n"," 　└outputs　※生成データのコピー用受け皿フォルダ（フォルダのみでOK）"],"metadata":{"id":"2d6jj_Vmg9_p"}},{"cell_type":"markdown","source":["★このノートブックの使い方★\n","\n","～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～\n","\n","①まずメニュー項目の「ランタイム」から\n"," → ランタイムの変更（いずれかのGPUタイプを選択）\n","\n","②【01】の実行ボタン（▶）を押す、\n","\n","（▶）の左に✅が付いたら次の（▶）を順番に押していく\n","\n","※または「ランタイム」から「すべてのセルを実行」を実行する\n","\n","③【06】の処理が進み、 https://～～～～～～～～.gradio.live\n","と表示されたら、そのURLをクリック\n","\n","④WEB-UIを停止するときは【05】の（▶）を押して処理をクルクルを停止\n","\n","⑤再度WEB-UIを使用する際は、【05】の（▶）を押し③と同様\n","\n","⑥生成したデータを保存する場合は【06】の（▶）を実行\n","\n","～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～\n","\n","\n","以下、「StableDiffusion_AnimateDiff環境」の起動手順です。"],"metadata":{"id":"Z7-3iE4Ta8v0"}},{"cell_type":"markdown","metadata":{"id":"xaBMLZ3T6xDU"},"source":["👇【01】Googleドライブのデータをここへマウント\n","\n","※Googleドライブにある、checkpoint、LoRA、VAE、Embedding、ControlNet用のツールモデル等を参照できるようにする\n","\n","↓の（▶）を押し、出現するポップアップウィンドウから\n","\n","　 Googleドライブに接続 → 「アカウントの選択」 → 「アクセスを許可」"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":73165,"status":"ok","timestamp":1704266862257,"user":{"displayName":"道草雑草（ざすお）","userId":"17895117177603075527"},"user_tz":-540},"id":"57uc9RXg2H0d","outputId":"c0bbdd9c-5cd8-4618-b269-3f14305e1e9e"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')\n"]},{"cell_type":"code","source":[],"metadata":{"id":"tEl1lWlbg5Nv"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"n5imcv6kBQqY"},"source":["👇【02】WEB-UIと各種_拡張機能のクローン（起動前にあらかじめ導入）※お好みで増減可能"]},{"cell_type":"code","source":[],"metadata":{"id":"xZSerOZagpqA"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RSEEtcqV23j6","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1704274146436,"user_tz":-540,"elapsed":5649,"user":{"displayName":"道草雑草（ざすお）","userId":"17895117177603075527"}},"outputId":"cf0b0f0a-8dca-4404-e048-7edc61c3e1b8"},"outputs":[{"output_type":"stream","name":"stdout","text":["Cloning into 'stable-diffusion-webui'...\n","remote: Enumerating objects: 30154, done.\u001b[K\n","remote: Counting objects: 100% (589/589), done.\u001b[K\n","remote: Compressing objects: 100% (286/286), done.\u001b[K\n","remote: Total 30154 (delta 348), reused 472 (delta 291), pack-reused 29565\u001b[K\n","Receiving objects: 100% (30154/30154), 33.34 MiB | 28.01 MiB/s, done.\n","Resolving deltas: 100% (21062/21062), done.\n","/content/stable-diffusion-webui/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'sd-webui-controlnet' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'sd-webui-animatediff' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'stable-diffusion-webui-images-browser' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'sd-webui-deforum' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'Styles-Editor' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'adetailer' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'sd-webui-aspect-ratio-helper' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'sd-dynamic-prompts' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'sdweb-easy-prompt-selector' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'sd_lama_cleaner' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n","/content/stable-diffusion-webui/extensions\n","fatal: destination path 'sd-webui-prompt-all-in-one' already exists and is not an empty directory.\n","/content/stable-diffusion-webui\n"]}],"source":["# Stable Diffusion Web-UIのクローン\n","!git clone https://github.com/AUTOMATIC1111/stable-diffusion-webui.git\n","%cd stable-diffusion-webui\n","\n","# Control Netのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/Mikubill/sd-webui-controlnet.git\n","%cd /content/stable-diffusion-webui\n","\n","# AnimateDiffのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/continue-revolution/sd-webui-animatediff.git\n","%cd /content/stable-diffusion-webui\n","\n","# images-browserのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/AlUlkesh/stable-diffusion-webui-images-browser.git\n","%cd /content/stable-diffusion-webui\n","\n","# Deforumのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/deforum-art/sd-webui-deforum.git\n","%cd /content/stable-diffusion-webui\n","\n","# Styles-Editorのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/chrisgoringe/Styles-Editor.git\n","%cd /content/stable-diffusion-webui\n","\n","# adetailerのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/Bing-su/adetailer.git\n","%cd /content/stable-diffusion-webui\n","\n","# aspect-ratio-helperのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/thomasasfk/sd-webui-aspect-ratio-helper.git\n","%cd /content/stable-diffusion-webui\n","\n","# sd-dynamic-promptsのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/adieyal/sd-dynamic-prompts.git\n","%cd /content/stable-diffusion-webui\n","\n","# easy-prompt-selectorのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/blue-pen5805/sdweb-easy-prompt-selector.git\n","%cd /content/stable-diffusion-webui\n","\n","# lama_cleanerのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/aka7774/sd_lama_cleaner.git\n","%cd /content/stable-diffusion-webui\n","\n","# prompt-all-in-oneのクローン\n","%cd /content/stable-diffusion-webui/extensions\n","!git clone https://github.com/Physton/sd-webui-prompt-all-in-one.git\n","%cd /content/stable-diffusion-webui"]},{"cell_type":"markdown","source":["👇【03】MP4形式の出力用に「ffpeg」をインストール"],"metadata":{"id":"UqQk7wCtWgzB"}},{"cell_type":"code","source":["%cd /content/stable-diffusion-webui/\n","!venv\\Scripts\\activate\n","!pip install imageio[ffmpeg]"],"metadata":{"id":"Y81eKNE1WJu-"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"qC6V3jX_y-5A"},"source":["👇【04】Googleドライブから、StyleEditorの移植と、「AnimateDiff」用の「MotionModel」をHugingFaceからDL"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CQALw2pL_rZO"},"outputs":[],"source":["%cd /content/stable-diffusion-webui/\n","\n","!cp -r \"/content/drive/MyDrive/StableDiffusion/Styles-Editor\" \"/content/stable-diffusion-webui/extensions\"\n","\n","!wget https://huggingface.co/conrevo/AnimateDiff-A1111/resolve/main/motion_module/mm_sd14_v1.safetensors --directory-prefix=/content/stable-diffusion-webui/extensions/sd-webui-animatediff/model\n","\n","!wget https://huggingface.co/conrevo/AnimateDiff-A1111/resolve/main/motion_module/mm_sd15_v1.safetensors --directory-prefix=/content/stable-diffusion-webui/extensions/sd-webui-animatediff/model\n","\n","!wget https://huggingface.co/conrevo/AnimateDiff-A1111/resolve/main/motion_module/mm_sd15_v2.safetensors --directory-prefix=/content/stable-diffusion-webui/extensions/sd-webui-animatediff/model\n","\n","!wget https://huggingface.co/conrevo/AnimateDiff-A1111/resolve/main/motion_module/mm_sd15_v3.safetensors --directory-prefix=/content/stable-diffusion-webui/extensions/sd-webui-animatediff/model"]},{"cell_type":"markdown","metadata":{"id":"IvSENcyKz-ZX"},"source":["👇【05】WEB-UIの起動（各種大容量データはGoogleドライブを参照する設定） ※起動オプション追記もお好みで可能"]},{"cell_type":"markdown","source":["★ WEB-UIの「停止」と「再起動」も↓の（▶）で操作します。"],"metadata":{"id":"3w5vN2jGZOcq"}},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"epSTotC65qBC","outputId":"956657f7-fcd9-41a3-a9aa-c8c59f165db1","executionInfo":{"status":"ok","timestamp":1704282729362,"user_tz":-540,"elapsed":919680,"user":{"displayName":"道草雑草（ざすお）","userId":"17895117177603075527"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Python 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0]\n","Version: v1.7.0\n","Commit hash: cf2772fab0af5573da775e7437e6acdca424f26e\n","Launching Web UI with arguments: --share --ckpt-dir /content/drive/MyDrive/StableDiffusion/checkpoints --embeddings-dir /content/drive/MyDrive/StableDiffusion/embeddings --lora-dir /content/drive/MyDrive/StableDiffusion/lora --vae-dir /content/drive/MyDrive/StableDiffusion/vae --controlnet-dir /content/drive/MyDrive/StableDiffusion/controlnet\n","2024-01-03 11:24:32.973851: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n","2024-01-03 11:24:32.973901: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n","2024-01-03 11:24:32.975376: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n","2024-01-03 11:24:34.315112: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\n","no module 'xformers'. Processing without...\n","no module 'xformers'. Processing without...\n","No module 'xformers'. Proceeding without it.\n","\u001b[1m[\u001b[0m-\u001b[1m]\u001b[0m ADetailer initialized. version: \u001b[1;36m23.12\u001b[0m.\u001b[1;36m0\u001b[0m, num models: \u001b[1;36m9\u001b[0m\n","ControlNet preprocessor location: /content/stable-diffusion-webui/extensions/sd-webui-controlnet/annotator/downloads\n","2024-01-03 11:24:38,723 - ControlNet - \u001b[0;32mINFO\u001b[0m - ControlNet v1.1.426\n","2024-01-03 11:24:39,107 - ControlNet - \u001b[0;32mINFO\u001b[0m - ControlNet v1.1.426\n","sd-webui-prompt-all-in-one background API service started successfully.\n","*** Error loading script: lama_cleaner_lama.py\n","    Traceback (most recent call last):\n","      File \"/content/stable-diffusion-webui/modules/scripts.py\", line 469, in load_scripts\n","        script_module = script_loading.load_module(scriptfile.path)\n","      File \"/content/stable-diffusion-webui/modules/script_loading.py\", line 10, in load_module\n","        module_spec.loader.exec_module(module)\n","      File \"<frozen importlib._bootstrap_external>\", line 883, in exec_module\n","      File \"<frozen importlib._bootstrap>\", line 241, in _call_with_frames_removed\n","      File \"/content/stable-diffusion-webui/extensions/sd_lama_cleaner/scripts/lama_cleaner_lama.py\", line 3, in <module>\n","        from lama_cleaner.server import main\n","    ModuleNotFoundError: No module named 'lama_cleaner'\n","\n","---\n","Loading weights [3d1b3c42ec] from /content/drive/MyDrive/StableDiffusion/checkpoints/awpainting_v12.safetensors\n","2024-01-03 11:24:39,521 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Injecting LCM to UI.\n","2024-01-03 11:24:40,200 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Hacking i2i-batch.\n","Creating model from config: /content/stable-diffusion-webui/configs/v1-inference.yaml\n","\u001b[0;32m*Deforum ControlNet support: enabled*\u001b[0m\n","Running on local URL:  http://127.0.0.1:7860\n","Running on public URL: https://29daf68ff2359128d3.gradio.live\n","\n","This share link expires in 72 hours. For free permanent hosting and GPU upgrades, run `gradio deploy` from Terminal to deploy to Spaces (https://huggingface.co/spaces)\n","Startup time: 20.6s (prepare environment: 3.1s, import torch: 4.1s, import gradio: 1.1s, setup paths: 3.0s, initialize shared: 0.2s, other imports: 0.8s, setup codeformer: 0.1s, load scripts: 3.0s, create ui: 2.5s, gradio launch: 2.1s, app_started_callback: 0.6s).\n","Applying attention optimization: Doggettx... done.\n","Model loaded in 6.2s (load weights from disk: 1.0s, create model: 1.6s, apply weights to model: 2.7s, load textual inversion embeddings: 0.5s, calculate empty prompt: 0.2s).\n","2024-01-03 11:25:42,620 - ControlNet - \u001b[0;33mWARNING\u001b[0m - Failed to parse infotext, legacy format infotext is no longer supported:\n","Module: openpose_full, Model: control_v11p_sd15_openpose [cab727d4], Weight: 1, Resize Mode: Crop and Resize, Low Vram: False, Processor Res: 512, Guidance Start: 0, Guidance End: 1, Pixel Perfect: True, Control Mode: Balanced, Hr Option: Both, Save Detected Map: True\n","2024-01-03 11:27:03,159 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - AnimateDiff process start.\n","2024-01-03 11:27:03,159 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Loading motion module mm_sd15_v2.safetensors from /content/stable-diffusion-webui/extensions/sd-webui-animatediff/model/mm_sd15_v2.safetensors\n","2024-01-03 11:27:03,235 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Guessed mm_sd15_v2.safetensors architecture: MotionModuleType.AnimateDiffV2\n","2024-01-03 11:27:07,206 - AnimateDiff - \u001b[0;33mWARNING\u001b[0m - Missing keys <All keys matched successfully>\n","2024-01-03 11:27:07,754 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Injecting motion module mm_sd15_v2.safetensors into SD1.5 UNet middle block.\n","2024-01-03 11:27:07,754 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Injecting motion module mm_sd15_v2.safetensors into SD1.5 UNet input blocks.\n","2024-01-03 11:27:07,754 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Injecting motion module mm_sd15_v2.safetensors into SD1.5 UNet output blocks.\n","2024-01-03 11:27:07,754 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Setting DDIM alpha.\n","2024-01-03 11:27:07,791 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Injection finished.\n","2024-01-03 11:27:07,791 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Hacking LoRA module to support motion LoRA\n","2024-01-03 11:27:07,791 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Hacking CFGDenoiser forward function.\n","2024-01-03 11:27:07,792 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Hacking ControlNet.\n","2024-01-03 11:27:08,742 - ControlNet - \u001b[0;32mINFO\u001b[0m - Loading model: control_v11p_sd15_openpose [cab727d4]\n","2024-01-03 11:27:10,007 - ControlNet - \u001b[0;32mINFO\u001b[0m - Loaded state_dict from [/content/drive/MyDrive/StableDiffusion/controlnet/control_v11p_sd15_openpose.pth]\n","2024-01-03 11:27:10,007 - ControlNet - \u001b[0;32mINFO\u001b[0m - controlnet_default_config\n","2024-01-03 11:27:13,154 - ControlNet - \u001b[0;32mINFO\u001b[0m - ControlNet model control_v11p_sd15_openpose [cab727d4] loaded.\n","2024-01-03 11:27:13,546 - ControlNet - \u001b[0;32mINFO\u001b[0m - Loading preprocessor: dw_openpose_full\n","2024-01-03 11:27:13,547 - ControlNet - \u001b[0;32mINFO\u001b[0m - preprocessor resolution = 512\n","100% 44/44 [01:31<00:00,  2.09s/it]\n","2024-01-03 11:28:45,937 - ControlNet - \u001b[0;32mINFO\u001b[0m - ControlNet Hooked - Time = 97.65088748931885\n","\n","  0% 0/30 [00:00<?, ?it/s]\n","  3% 1/30 [00:16<07:48, 16.15s/it]\n","  7% 2/30 [00:29<06:49, 14.63s/it]\n"," 10% 3/30 [00:43<06:23, 14.20s/it]\n"," 13% 4/30 [00:57<06:03, 13.96s/it]\n"," 17% 5/30 [01:10<05:46, 13.85s/it]\n"," 20% 6/30 [01:24<05:30, 13.78s/it]\n"," 23% 7/30 [01:37<05:16, 13.75s/it]\n"," 27% 8/30 [01:51<05:01, 13.72s/it]\n"," 30% 9/30 [02:05<04:47, 13.69s/it]\n"," 33% 10/30 [02:18<04:33, 13.69s/it]\n"," 37% 11/30 [02:32<04:20, 13.70s/it]\n"," 40% 12/30 [02:46<04:06, 13.70s/it]\n"," 43% 13/30 [03:00<03:52, 13.70s/it]\n"," 47% 14/30 [03:13<03:38, 13.68s/it]\n"," 50% 15/30 [03:27<03:24, 13.67s/it]\n"," 53% 16/30 [03:41<03:11, 13.67s/it]\n"," 57% 17/30 [03:54<02:57, 13.66s/it]\n"," 60% 18/30 [04:08<02:43, 13.66s/it]\n"," 63% 19/30 [04:22<02:30, 13.66s/it]\n"," 67% 20/30 [04:35<02:16, 13.68s/it]\n"," 70% 21/30 [04:49<02:03, 13.68s/it]\n"," 73% 22/30 [05:03<01:49, 13.69s/it]\n"," 77% 23/30 [05:16<01:35, 13.69s/it]\n"," 80% 24/30 [05:30<01:22, 13.69s/it]\n"," 83% 25/30 [05:44<01:08, 13.70s/it]\n"," 87% 26/30 [05:57<00:54, 13.70s/it]\n"," 90% 27/30 [06:11<00:41, 13.70s/it]\n"," 93% 28/30 [06:25<00:27, 13.70s/it]\n"," 97% 29/30 [06:38<00:13, 13.68s/it]\n","100% 30/30 [06:52<00:00, 13.76s/it]\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","  0% 0/30 [00:03<?, ?it/s]\n","*** Error completing request\n","*** Arguments: ('task(jp74brydmlqk0kf)', '(smile:1.2),', 'extra arms,missing arm,too long hair,', ['zasuko_defo_20231219'], 30, 'DPM++ 2M Karras', 1, 1, 7, 512, 768, True, 0.7, 1.5, 'R-ESRGAN 4x+ Anime6B', 0, 0, 0, 'Use same checkpoint', 'Use same sampler', '', '', [], <gradio.routes.Request object at 0x78b3c1dccc70>, 0, False, '', 0.8, 1209822421, False, -1, 0, 0, 0, True, False, {'ad_model': 'face_yolov8n.pt', 'ad_prompt': '', 'ad_negative_prompt': '', 'ad_confidence': 0.3, 'ad_mask_k_largest': 0, 'ad_mask_min_ratio': 0, 'ad_mask_max_ratio': 1, 'ad_x_offset': 0, 'ad_y_offset': 0, 'ad_dilate_erode': 4, 'ad_mask_merge_invert': 'None', 'ad_mask_blur': 4, 'ad_denoising_strength': 0.4, 'ad_inpaint_only_masked': True, 'ad_inpaint_only_masked_padding': 32, 'ad_use_inpaint_width_height': False, 'ad_inpaint_width': 512, 'ad_inpaint_height': 512, 'ad_use_steps': False, 'ad_steps': 28, 'ad_use_cfg_scale': False, 'ad_cfg_scale': 7, 'ad_use_checkpoint': False, 'ad_checkpoint': 'Use same checkpoint', 'ad_use_vae': False, 'ad_vae': 'Use same VAE', 'ad_use_sampler': False, 'ad_sampler': 'DPM++ 2M Karras', 'ad_use_noise_multiplier': False, 'ad_noise_multiplier': 1, 'ad_use_clip_skip': False, 'ad_clip_skip': 1, 'ad_restore_face': False, 'ad_controlnet_model': 'None', 'ad_controlnet_module': 'None', 'ad_controlnet_weight': 1, 'ad_controlnet_guidance_start': 0, 'ad_controlnet_guidance_end': 1, 'is_api': ()}, {'ad_model': 'None', 'ad_prompt': '', 'ad_negative_prompt': '', 'ad_confidence': 0.3, 'ad_mask_k_largest': 0, 'ad_mask_min_ratio': 0, 'ad_mask_max_ratio': 1, 'ad_x_offset': 0, 'ad_y_offset': 0, 'ad_dilate_erode': 4, 'ad_mask_merge_invert': 'None', 'ad_mask_blur': 4, 'ad_denoising_strength': 0.4, 'ad_inpaint_only_masked': True, 'ad_inpaint_only_masked_padding': 32, 'ad_use_inpaint_width_height': False, 'ad_inpaint_width': 512, 'ad_inpaint_height': 512, 'ad_use_steps': False, 'ad_steps': 28, 'ad_use_cfg_scale': False, 'ad_cfg_scale': 7, 'ad_use_checkpoint': False, 'ad_checkpoint': 'Use same checkpoint', 'ad_use_vae': False, 'ad_vae': 'Use same VAE', 'ad_use_sampler': False, 'ad_sampler': 'DPM++ 2M Karras', 'ad_use_noise_multiplier': False, 'ad_noise_multiplier': 1, 'ad_use_clip_skip': False, 'ad_clip_skip': 1, 'ad_restore_face': False, 'ad_controlnet_model': 'None', 'ad_controlnet_module': 'None', 'ad_controlnet_weight': 1, 'ad_controlnet_guidance_start': 0, 'ad_controlnet_guidance_end': 1, 'is_api': ()}, False, False, 1, False, False, False, 1.1, 1.5, 100, 0.7, False, False, True, False, False, 0, 'Gustavosta/MagicPrompt-Stable-Diffusion', '', <scripts.animatediff_ui.AnimateDiffProcess object at 0x78b3c1dcd810>, UiControlNetUnit(enabled=True, module='dw_openpose_full', model='control_v11p_sd15_openpose [cab727d4]', weight=1, image=None, resize_mode='Crop and Resize', low_vram=False, processor_res=512, threshold_a=-1, threshold_b=-1, guidance_start=0, guidance_end=1, pixel_perfect=True, control_mode='Balanced', inpaint_crop_input_image=True, hr_option='Both', save_detected_map=True, advanced_weighting=None), UiControlNetUnit(enabled=False, module='none', model='None', weight=1, image=None, resize_mode='Crop and Resize', low_vram=False, processor_res=-1, threshold_a=-1, threshold_b=-1, guidance_start=0, guidance_end=1, pixel_perfect=False, control_mode='Balanced', inpaint_crop_input_image=False, hr_option='Both', save_detected_map=True, advanced_weighting=None), UiControlNetUnit(enabled=False, module='none', model='None', weight=1, image=None, resize_mode='Crop and Resize', low_vram=False, processor_res=-1, threshold_a=-1, threshold_b=-1, guidance_start=0, guidance_end=1, pixel_perfect=False, control_mode='Balanced', inpaint_crop_input_image=False, hr_option='Both', save_detected_map=True, advanced_weighting=None), '🔄', False, False, 'positive', 'comma', 0, False, False, 'start', '', 1, '', [], 0, '', [], 0, '', [], True, False, False, False, 0, False, None, None, False, None, None, False, None, None, False, 50) {}\n","    Traceback (most recent call last):\n","      File \"/content/stable-diffusion-webui/modules/call_queue.py\", line 57, in f\n","        res = list(func(*args, **kwargs))\n","      File \"/content/stable-diffusion-webui/modules/call_queue.py\", line 36, in f\n","        res = func(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/modules/txt2img.py\", line 55, in txt2img\n","        processed = processing.process_images(p)\n","      File \"/content/stable-diffusion-webui/modules/processing.py\", line 734, in process_images\n","        res = process_images_inner(p)\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-animatediff/scripts/animatediff_cn.py\", line 119, in hacked_processing_process_images_hijack\n","        return getattr(processing, '__controlnet_original_process_images_inner')(p, *args, **kwargs)\n","      File \"/content/stable-diffusion-webui/modules/processing.py\", line 868, in process_images_inner\n","        samples_ddim = p.sample(conditioning=p.c, unconditional_conditioning=p.uc, seeds=p.seeds, subseeds=p.subseeds, subseed_strength=p.subseed_strength, prompts=p.prompts)\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/hook.py\", line 435, in process_sample\n","        return process.sample_before_CN_hack(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/modules/processing.py\", line 1157, in sample\n","        return self.sample_hr_pass(samples, decoded_samples, seeds, subseeds, subseed_strength, prompts)\n","      File \"/content/stable-diffusion-webui/modules/processing.py\", line 1242, in sample_hr_pass\n","        samples = self.sampler.sample_img2img(self, samples, noise, self.hr_c, self.hr_uc, steps=self.hr_second_pass_steps or self.steps, image_conditioning=image_conditioning)\n","      File \"/content/stable-diffusion-webui/modules/sd_samplers_kdiffusion.py\", line 188, in sample_img2img\n","        samples = self.launch_sampling(t_enc + 1, lambda: self.func(self.model_wrap_cfg, xi, extra_args=self.sampler_extra_args, disable=False, callback=self.callback_state, **extra_params_kwargs))\n","      File \"/content/stable-diffusion-webui/modules/sd_samplers_common.py\", line 261, in launch_sampling\n","        return func()\n","      File \"/content/stable-diffusion-webui/modules/sd_samplers_kdiffusion.py\", line 188, in <lambda>\n","        samples = self.launch_sampling(t_enc + 1, lambda: self.func(self.model_wrap_cfg, xi, extra_args=self.sampler_extra_args, disable=False, callback=self.callback_state, **extra_params_kwargs))\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py\", line 115, in decorate_context\n","        return func(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/k-diffusion/k_diffusion/sampling.py\", line 594, in sample_dpmpp_2m\n","        denoised = model(x, sigmas[i] * s_in, **extra_args)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-animatediff/scripts/animatediff_infv2v.py\", line 250, in mm_cfg_forward\n","        x_out = mm_sd_forward(self, x_in, sigma_in, cond_in, image_cond_in, make_condition_dict) # hook\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-animatediff/scripts/animatediff_infv2v.py\", line 160, in mm_sd_forward\n","        out = self.inner_model(\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/k-diffusion/k_diffusion/external.py\", line 112, in forward\n","        eps = self.get_eps(input * c_in, self.sigma_to_t(sigma), **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/k-diffusion/k_diffusion/external.py\", line 138, in get_eps\n","        return self.inner_model.apply_model(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/modules/sd_hijack_utils.py\", line 17, in <lambda>\n","        setattr(resolved_obj, func_path[-1], lambda *args, **kwargs: self(*args, **kwargs))\n","      File \"/content/stable-diffusion-webui/modules/sd_hijack_utils.py\", line 28, in __call__\n","        return self.__orig_func(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/models/diffusion/ddpm.py\", line 858, in apply_model\n","        x_recon = self.model(x_noisy, t, **cond)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/models/diffusion/ddpm.py\", line 1335, in forward\n","        out = self.diffusion_model(x, t, context=cc)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/hook.py\", line 845, in forward_webui\n","        raise e\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/hook.py\", line 842, in forward_webui\n","        return forward(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/hook.py\", line 749, in forward\n","        h = module(h, emb, context)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/diffusionmodules/openaimodel.py\", line 84, in forward\n","        x = layer(x, context)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/attention.py\", line 334, in forward\n","        x = block(x, context=context[i])\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/attention.py\", line 269, in forward\n","        return checkpoint(self._forward, (x, context), self.parameters(), self.checkpoint)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/diffusionmodules/util.py\", line 121, in checkpoint\n","        return CheckpointFunction.apply(func, len(inputs), *args)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","        return super().apply(*args, **kwargs)  # type: ignore[misc]\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/diffusionmodules/util.py\", line 136, in forward\n","        output_tensors = ctx.run_function(*ctx.input_tensors)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/attention.py\", line 272, in _forward\n","        x = self.attn1(self.norm1(x), context=context if self.disable_self_attn else None) + x\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/modules/sd_hijack_optimizations.py\", line 260, in split_cross_attention_forward\n","        raise RuntimeError(f'Not enough memory, use lower resolution (max approx. {max_res}x{max_res}). '\n","    RuntimeError: Not enough memory, use lower resolution (max approx. 1536x1536). Need: 4.3GB free, Have:3.2GB free\n","\n","---\n","2024-01-03 11:39:20,008 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - AnimateDiff process start.\n","2024-01-03 11:39:20,008 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Motion module already injected. Trying to restore.\n","2024-01-03 11:39:20,008 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Restoring DDIM alpha.\n","2024-01-03 11:39:20,009 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Removing motion module from SD1.5 UNet input blocks.\n","2024-01-03 11:39:20,009 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Removing motion module from SD1.5 UNet output blocks.\n","2024-01-03 11:39:20,009 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Removing motion module from SD1.5 UNet middle block.\n","2024-01-03 11:39:20,009 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Removal finished.\n","2024-01-03 11:39:20,022 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Injecting motion module mm_sd15_v2.safetensors into SD1.5 UNet middle block.\n","2024-01-03 11:39:20,023 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Injecting motion module mm_sd15_v2.safetensors into SD1.5 UNet input blocks.\n","2024-01-03 11:39:20,023 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Injecting motion module mm_sd15_v2.safetensors into SD1.5 UNet output blocks.\n","2024-01-03 11:39:20,023 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Setting DDIM alpha.\n","2024-01-03 11:39:20,026 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Injection finished.\n","2024-01-03 11:39:20,026 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - AnimateDiff LoRA already hacked\n","2024-01-03 11:39:20,026 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - CFGDenoiser already hacked\n","2024-01-03 11:39:20,026 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - Hacking ControlNet.\n","2024-01-03 11:39:20,026 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - BatchHijack already hacked.\n","2024-01-03 11:39:20,026 - AnimateDiff - \u001b[0;32mINFO\u001b[0m - ControlNet Main Entry already hacked.\n","2024-01-03 11:39:20,592 - ControlNet - \u001b[0;32mINFO\u001b[0m - Loading model from cache: control_v11p_sd15_openpose [cab727d4]\n","2024-01-03 11:39:20,956 - ControlNet - \u001b[0;32mINFO\u001b[0m - Loading preprocessor: dw_openpose_full\n","2024-01-03 11:39:20,956 - ControlNet - \u001b[0;32mINFO\u001b[0m - preprocessor resolution = 512\n","100% 44/44 [01:30<00:00,  2.06s/it]\n","2024-01-03 11:40:52,107 - ControlNet - \u001b[0;32mINFO\u001b[0m - ControlNet Hooked - Time = 91.603524684906\n","  0% 0/30 [00:00<?, ?it/s]\n","  3% 1/30 [00:15<07:22, 15.28s/it]\n","  7% 2/30 [00:30<07:04, 15.16s/it]\n"," 10% 3/30 [00:45<06:47, 15.09s/it]\n"," 13% 4/30 [01:00<06:33, 15.12s/it]\n"," 17% 5/30 [01:15<06:17, 15.08s/it]\n"," 20% 6/30 [01:30<06:02, 15.09s/it]\n"," 23% 7/30 [01:45<05:47, 15.09s/it]\n"," 27% 8/30 [02:00<05:31, 15.08s/it]\n"," 30% 9/30 [02:15<05:16, 15.09s/it]\n"," 33% 10/30 [02:31<05:01, 15.09s/it]\n"," 37% 11/30 [02:46<04:46, 15.08s/it]\n"," 40% 12/30 [03:01<04:32, 15.12s/it]\n"," 43% 13/30 [03:16<04:16, 15.12s/it]\n"," 47% 14/30 [03:31<04:01, 15.12s/it]\n"," 50% 15/30 [03:46<03:46, 15.13s/it]\n"," 53% 16/30 [04:01<03:31, 15.13s/it]\n"," 57% 17/30 [04:16<03:16, 15.13s/it]\n"," 60% 18/30 [04:32<03:01, 15.15s/it]\n"," 63% 19/30 [04:47<02:46, 15.12s/it]\n"," 67% 20/30 [05:02<02:31, 15.13s/it]\n"," 70% 21/30 [05:17<02:16, 15.14s/it]\n"," 73% 22/30 [05:32<02:01, 15.14s/it]\n"," 77% 23/30 [05:47<01:45, 15.12s/it]\n"," 80% 24/30 [06:02<01:30, 15.12s/it]\n"," 83% 25/30 [06:17<01:15, 15.11s/it]\n"," 87% 26/30 [06:33<01:00, 15.15s/it]\n"," 90% 27/30 [06:48<00:45, 15.15s/it]\n"," 93% 28/30 [07:03<00:30, 15.12s/it]\n"," 97% 29/30 [07:18<00:15, 15.12s/it]\n","100% 30/30 [07:33<00:00, 15.12s/it]\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","\tTile 1/15\n","\tTile 2/15\n","\tTile 3/15\n","\tTile 4/15\n","\tTile 5/15\n","\tTile 6/15\n","\tTile 7/15\n","\tTile 8/15\n","\tTile 9/15\n","\tTile 10/15\n","\tTile 11/15\n","\tTile 12/15\n","\tTile 13/15\n","\tTile 14/15\n","\tTile 15/15\n","  0% 0/30 [00:03<?, ?it/s]\n","*** Error completing request\n","*** Arguments: ('task(70y8eka2nzsmgxr)', '(smile:1.2),', 'extra arms,missing arm,too long hair,', ['zasuko_defo_20231219'], 30, 'DPM++ 2M Karras', 1, 1, 7, 512, 768, True, 0.7, 1.5, 'R-ESRGAN 4x+ Anime6B', 0, 0, 0, 'Use same checkpoint', 'Use same sampler', '', '', [], <gradio.routes.Request object at 0x78b3c1deddb0>, 0, False, '', 0.8, 1209822421, False, -1, 0, 0, 0, True, False, {'ad_model': 'face_yolov8n.pt', 'ad_prompt': '', 'ad_negative_prompt': '', 'ad_confidence': 0.3, 'ad_mask_k_largest': 0, 'ad_mask_min_ratio': 0, 'ad_mask_max_ratio': 1, 'ad_x_offset': 0, 'ad_y_offset': 0, 'ad_dilate_erode': 4, 'ad_mask_merge_invert': 'None', 'ad_mask_blur': 4, 'ad_denoising_strength': 0.4, 'ad_inpaint_only_masked': True, 'ad_inpaint_only_masked_padding': 32, 'ad_use_inpaint_width_height': False, 'ad_inpaint_width': 512, 'ad_inpaint_height': 512, 'ad_use_steps': False, 'ad_steps': 28, 'ad_use_cfg_scale': False, 'ad_cfg_scale': 7, 'ad_use_checkpoint': False, 'ad_checkpoint': 'Use same checkpoint', 'ad_use_vae': False, 'ad_vae': 'Use same VAE', 'ad_use_sampler': False, 'ad_sampler': 'DPM++ 2M Karras', 'ad_use_noise_multiplier': False, 'ad_noise_multiplier': 1, 'ad_use_clip_skip': False, 'ad_clip_skip': 1, 'ad_restore_face': False, 'ad_controlnet_model': 'None', 'ad_controlnet_module': 'None', 'ad_controlnet_weight': 1, 'ad_controlnet_guidance_start': 0, 'ad_controlnet_guidance_end': 1, 'is_api': ()}, {'ad_model': 'None', 'ad_prompt': '', 'ad_negative_prompt': '', 'ad_confidence': 0.3, 'ad_mask_k_largest': 0, 'ad_mask_min_ratio': 0, 'ad_mask_max_ratio': 1, 'ad_x_offset': 0, 'ad_y_offset': 0, 'ad_dilate_erode': 4, 'ad_mask_merge_invert': 'None', 'ad_mask_blur': 4, 'ad_denoising_strength': 0.4, 'ad_inpaint_only_masked': True, 'ad_inpaint_only_masked_padding': 32, 'ad_use_inpaint_width_height': False, 'ad_inpaint_width': 512, 'ad_inpaint_height': 512, 'ad_use_steps': False, 'ad_steps': 28, 'ad_use_cfg_scale': False, 'ad_cfg_scale': 7, 'ad_use_checkpoint': False, 'ad_checkpoint': 'Use same checkpoint', 'ad_use_vae': False, 'ad_vae': 'Use same VAE', 'ad_use_sampler': False, 'ad_sampler': 'DPM++ 2M Karras', 'ad_use_noise_multiplier': False, 'ad_noise_multiplier': 1, 'ad_use_clip_skip': False, 'ad_clip_skip': 1, 'ad_restore_face': False, 'ad_controlnet_model': 'None', 'ad_controlnet_module': 'None', 'ad_controlnet_weight': 1, 'ad_controlnet_guidance_start': 0, 'ad_controlnet_guidance_end': 1, 'is_api': ()}, False, False, 1, False, False, False, 1.1, 1.5, 100, 0.7, False, False, True, False, False, 0, 'Gustavosta/MagicPrompt-Stable-Diffusion', '', <scripts.animatediff_ui.AnimateDiffProcess object at 0x78b3bc53e260>, UiControlNetUnit(enabled=True, module='dw_openpose_full', model='control_v11p_sd15_openpose [cab727d4]', weight=1, image=None, resize_mode='Crop and Resize', low_vram=True, processor_res=512, threshold_a=-1, threshold_b=-1, guidance_start=0, guidance_end=1, pixel_perfect=True, control_mode='Balanced', inpaint_crop_input_image=True, hr_option='Both', save_detected_map=True, advanced_weighting=None), UiControlNetUnit(enabled=False, module='none', model='None', weight=1, image=None, resize_mode='Crop and Resize', low_vram=False, processor_res=-1, threshold_a=-1, threshold_b=-1, guidance_start=0, guidance_end=1, pixel_perfect=False, control_mode='Balanced', inpaint_crop_input_image=False, hr_option='Both', save_detected_map=True, advanced_weighting=None), UiControlNetUnit(enabled=False, module='none', model='None', weight=1, image=None, resize_mode='Crop and Resize', low_vram=False, processor_res=-1, threshold_a=-1, threshold_b=-1, guidance_start=0, guidance_end=1, pixel_perfect=False, control_mode='Balanced', inpaint_crop_input_image=False, hr_option='Both', save_detected_map=True, advanced_weighting=None), '🔄', False, False, 'positive', 'comma', 0, False, False, 'start', '', 1, '', [], 0, '', [], 0, '', [], True, False, False, False, 0, False, None, None, False, None, None, False, None, None, False, 50) {}\n","    Traceback (most recent call last):\n","      File \"/content/stable-diffusion-webui/modules/call_queue.py\", line 57, in f\n","        res = list(func(*args, **kwargs))\n","      File \"/content/stable-diffusion-webui/modules/call_queue.py\", line 36, in f\n","        res = func(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/modules/txt2img.py\", line 55, in txt2img\n","        processed = processing.process_images(p)\n","      File \"/content/stable-diffusion-webui/modules/processing.py\", line 734, in process_images\n","        res = process_images_inner(p)\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-animatediff/scripts/animatediff_cn.py\", line 119, in hacked_processing_process_images_hijack\n","        return getattr(processing, '__controlnet_original_process_images_inner')(p, *args, **kwargs)\n","      File \"/content/stable-diffusion-webui/modules/processing.py\", line 868, in process_images_inner\n","        samples_ddim = p.sample(conditioning=p.c, unconditional_conditioning=p.uc, seeds=p.seeds, subseeds=p.subseeds, subseed_strength=p.subseed_strength, prompts=p.prompts)\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/hook.py\", line 435, in process_sample\n","        return process.sample_before_CN_hack(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/modules/processing.py\", line 1157, in sample\n","        return self.sample_hr_pass(samples, decoded_samples, seeds, subseeds, subseed_strength, prompts)\n","      File \"/content/stable-diffusion-webui/modules/processing.py\", line 1242, in sample_hr_pass\n","        samples = self.sampler.sample_img2img(self, samples, noise, self.hr_c, self.hr_uc, steps=self.hr_second_pass_steps or self.steps, image_conditioning=image_conditioning)\n","      File \"/content/stable-diffusion-webui/modules/sd_samplers_kdiffusion.py\", line 188, in sample_img2img\n","        samples = self.launch_sampling(t_enc + 1, lambda: self.func(self.model_wrap_cfg, xi, extra_args=self.sampler_extra_args, disable=False, callback=self.callback_state, **extra_params_kwargs))\n","      File \"/content/stable-diffusion-webui/modules/sd_samplers_common.py\", line 261, in launch_sampling\n","        return func()\n","      File \"/content/stable-diffusion-webui/modules/sd_samplers_kdiffusion.py\", line 188, in <lambda>\n","        samples = self.launch_sampling(t_enc + 1, lambda: self.func(self.model_wrap_cfg, xi, extra_args=self.sampler_extra_args, disable=False, callback=self.callback_state, **extra_params_kwargs))\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py\", line 115, in decorate_context\n","        return func(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/k-diffusion/k_diffusion/sampling.py\", line 594, in sample_dpmpp_2m\n","        denoised = model(x, sigmas[i] * s_in, **extra_args)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-animatediff/scripts/animatediff_infv2v.py\", line 250, in mm_cfg_forward\n","        x_out = mm_sd_forward(self, x_in, sigma_in, cond_in, image_cond_in, make_condition_dict) # hook\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-animatediff/scripts/animatediff_infv2v.py\", line 160, in mm_sd_forward\n","        out = self.inner_model(\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/k-diffusion/k_diffusion/external.py\", line 112, in forward\n","        eps = self.get_eps(input * c_in, self.sigma_to_t(sigma), **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/k-diffusion/k_diffusion/external.py\", line 138, in get_eps\n","        return self.inner_model.apply_model(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/modules/sd_hijack_utils.py\", line 17, in <lambda>\n","        setattr(resolved_obj, func_path[-1], lambda *args, **kwargs: self(*args, **kwargs))\n","      File \"/content/stable-diffusion-webui/modules/sd_hijack_utils.py\", line 28, in __call__\n","        return self.__orig_func(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/models/diffusion/ddpm.py\", line 858, in apply_model\n","        x_recon = self.model(x_noisy, t, **cond)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/models/diffusion/ddpm.py\", line 1335, in forward\n","        out = self.diffusion_model(x, t, context=cc)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/hook.py\", line 845, in forward_webui\n","        raise e\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/hook.py\", line 842, in forward_webui\n","        return forward(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/extensions/sd-webui-controlnet/scripts/hook.py\", line 749, in forward\n","        h = module(h, emb, context)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/diffusionmodules/openaimodel.py\", line 84, in forward\n","        x = layer(x, context)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/attention.py\", line 334, in forward\n","        x = block(x, context=context[i])\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/attention.py\", line 269, in forward\n","        return checkpoint(self._forward, (x, context), self.parameters(), self.checkpoint)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/diffusionmodules/util.py\", line 121, in checkpoint\n","        return CheckpointFunction.apply(func, len(inputs), *args)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/autograd/function.py\", line 539, in apply\n","        return super().apply(*args, **kwargs)  # type: ignore[misc]\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/diffusionmodules/util.py\", line 136, in forward\n","        output_tensors = ctx.run_function(*ctx.input_tensors)\n","      File \"/content/stable-diffusion-webui/repositories/stable-diffusion-stability-ai/ldm/modules/attention.py\", line 272, in _forward\n","        x = self.attn1(self.norm1(x), context=context if self.disable_self_attn else None) + x\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1518, in _wrapped_call_impl\n","        return self._call_impl(*args, **kwargs)\n","      File \"/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\", line 1527, in _call_impl\n","        return forward_call(*args, **kwargs)\n","      File \"/content/stable-diffusion-webui/modules/sd_hijack_optimizations.py\", line 260, in split_cross_attention_forward\n","        raise RuntimeError(f'Not enough memory, use lower resolution (max approx. {max_res}x{max_res}). '\n","    RuntimeError: Not enough memory, use lower resolution (max approx. 1600x1600). Need: 4.3GB free, Have:3.9GB free\n","\n","---\n","Interrupted with signal 2 in <frame at 0x78b3ac06cab0, file '/usr/lib/python3.10/threading.py', line 324, code wait>\n","Interrupted with signal 2 in <frame at 0x78b430cd3440, file '/content/stable-diffusion-webui/modules/options.py', line 112, code __getattr__>\n"]}],"source":["!python launch.py --share \\\n","  --ckpt-dir \"/content/drive/MyDrive/StableDiffusion/checkpoints\" \\\n","  --embeddings-dir \"/content/drive/MyDrive/StableDiffusion/embeddings\" \\\n","  --lora-dir \"/content/drive/MyDrive/StableDiffusion/lora\" \\\n","  --vae-dir \"/content/drive/MyDrive/StableDiffusion/vae\" \\\n","  --controlnet-dir \"/content/drive/MyDrive/StableDiffusion/controlnet\""]},{"cell_type":"markdown","metadata":{"id":"VRun12UM6vm_"},"source":["👇【06】一旦【05】の処理を停止させた後に（▶）を実行してください。\n","\n","生成したデータ「Outputデータ」をGoogleドライブへコピーします。\n","\n","≪注意≫フォルダごと追加するので、フォルダ構成が多重化していきます。\n","\n","※こまめにGoogleドライブ内の「outputs」フォルダのデータをローカルに移動と削除をしてください。"]},{"cell_type":"code","execution_count":15,"metadata":{"id":"MUUlLMA57_ck","executionInfo":{"status":"ok","timestamp":1704282736067,"user_tz":-540,"elapsed":3920,"user":{"displayName":"道草雑草（ざすお）","userId":"17895117177603075527"}}},"outputs":[],"source":["!cp -r \"/content/stable-diffusion-webui/outputs/txt2img-grids\" \"/content/drive/MyDrive/StableDiffusion/outputs/txt2img-grids\"\n","!cp -r \"/content/stable-diffusion-webui/outputs/txt2img-images\" \"/content/drive/MyDrive/StableDiffusion/outputs/txt2img-images\""]}],"metadata":{"accelerator":"GPU","colab":{"machine_shape":"hm","provenance":[{"file_id":"1Mmxpof01lcRmvpAmNYLvkO-hRwMji-06","timestamp":1704206856693}],"gpuType":"V100","toc_visible":true,"authorship_tag":"ABX9TyPuKjxK5d/qRqQbHWhcid5B"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}